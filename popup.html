<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8" />
  <title>Lexinoa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div id="app">
    <header class="popup-header">
      <div class="brand">
        <div class="brand-mark">L</div>
        <div class="brand-text">
          <div class="brand-title">Lexinoa</div>
          <div class="brand-subtitle" data-i18n="popupSubtitle">문장 순화 도우미</div>
        </div>
      </div>
    <div class="header-right" style="display:flex; gap:6px; align-items:center;">
  <select id="lang-select" class="select small" style="height:28px; padding:0 8px;">
    <option value="auto">AUTO</option>
    <option value="ko">korean</option>
    <option value="en">english</option>
  </select>
  <button id="open-web" class="btn ghost small" data-i18n="openWeb">웹 열기</button>
</div>

    </header>

    <section class="status-bar">
      <div id="status-tier" class="badge">-</div>
      <div id="status-usage" class="status-text" data-i18n="statusLoading">사용량 불러오는 중...</div>
    </section>

    <nav class="tabs">
      <button class="tab-button active" data-target="view-rewrite" data-i18n="tabRewrite">순화</button>
      <button class="tab-button" data-target="view-history" data-i18n="tabHistory">히스토리</button>
      <button class="tab-button" data-target="view-templates" data-i18n="tabTemplates">템플릿</button>
      <button class="tab-button" data-target="view-settings" data-i18n="tabSettings">설정</button>
    </nav>

    <main class="views">
      <!-- 순화 탭 -->
      <section id="view-rewrite" class="view active">
        <div class="context-row">
          <div class="context-label" data-i18n="contextDetect">플랫폼 감지</div>
          <div class="context-value" id="context-display" data-i18n="contextGeneric">일반 사이트</div>
          <select id="context-manual" class="context-select">
            <option value="auto" selected data-i18n="contextAuto">자동</option>
            <option value="gmail" data-i18n="contextGmail">Gmail</option>
            <option value="slack" data-i18n="contextSlack">Slack</option>
            <option value="naver_mail" data-i18n="contextNaverMail">네이버 메일</option>
            <option value="outlook" data-i18n="contextOutlook">Outlook</option>
            <option value="teams" data-i18n="contextTeams">Teams</option>
            <option value="kakao" data-i18n="contextKakao">카카오톡/카카오</option>
            <option value="generic" data-i18n="contextGenericOption">일반</option>
          </select>
        </div>

        <label class="field-label" for="input-text" data-i18n="fieldInput">입력</label>
        <textarea id="input-text" class="textarea" rows="5"
          placeholder="예) 왜 이렇게 늦게 보내세요? 다음부턴 제때 보내세요."
          data-i18n-placeholder="inputPlaceholder"></textarea>

        <div class="row">
          <div class="col">
            <label class="field-label" for="category-select" data-i18n="fieldCategory">카테고리</label>
            <div class="input-group">
              <select id="category-select" class="select">
                <option value="" disabled selected data-i18n="categorySelectPlaceholder">카테고리 선택…</option>
                <option value="general" data-i18n="catGeneral">일반</option>
                <option value="work" data-i18n="catWork">업무</option>
                <option value="support" data-i18n="catSupport">고객응대</option>
                <option value="apology" data-i18n="catApology">사과</option>
                <option value="inquiry" data-i18n="catInquiry">문의</option>
                <option value="thanks" data-i18n="catThanks">감사</option>
                <option value="request" data-i18n="catRequest">요청</option>
                <option value="guidance" data-i18n="catGuidance">안내</option>
                <option value="report/approval" data-i18n="catReport">보고/결재</option>
                <option value="feedback" data-i18n="catFeedback">피드백</option>
              </select>
            </div>
            <div id="category-chips" class="chipbox"></div>
          </div>

          <div class="col">
            <label class="field-label" for="tone-select" data-i18n="fieldTone">톤</label>
            <div class="input-group">
              <select id="tone-select" class="select">
                <option value="" disabled selected data-i18n="toneSelectPlaceholder">말투 선택…</option>
                <option value="soft" data-i18n="toneSoft">부드럽게</option>
                <option value="polite" data-i18n="tonePolite">정중하게</option>
                <option value="concise" data-i18n="toneConcise">간결하게</option>
                <option value="report" data-i18n="toneReport">보고서체</option>
                <option value="friendly" data-i18n="toneFriendly">친근하게</option>
                <option value="warmly" data-i18n="toneWarmly">따뜻하게</option>
                <option value="calmly" data-i18n="toneCalmly">차분하게</option>
                <option value="formally" data-i18n="toneFormally">격식 있게</option>
                <option value="clearly" data-i18n="toneClearly">명확하게</option>
                <option value="without_emotion" data-i18n="toneNoEmotion">감정 없이</option>
              </select>
            </div>
            <div id="tone-chips" class="chipbox"></div>
          </div>
        </div>

        <div class="checkbox-group">
          <label class="checkbox-item">
            <input type="checkbox" id="opt-honorific" />
            <span data-i18n="optHonorific">존댓말 유지</span>
          </label>
          <label class="checkbox-item">
            <input type="checkbox" id="opt-opener" />
            <span data-i18n="optOpener">완충문·인사 추가</span>
          </label>
          <label class="checkbox-item">
            <input type="checkbox" id="opt-emoji" />
            <span data-i18n="optEmoji">이모지 허용 🙂</span>
          </label>
        </div>

        <div class="template-row">
          <div class="template-label">
            <span data-i18n="templateLabel">템플릿</span>
            <span id="template-pro-badge" class="badge badge-pro" hidden data-i18n="proBadge">Pro</span>
          </div>
          <select id="template-select" class="select">
            <option value="" selected data-i18n="templateSelectPlaceholder">템플릿 선택…</option>
          </select>
          <button id="template-save-from-current" class="btn small secondary" data-i18n="templateSaveCurrent">현재 설정 저장</button>
        </div>

        <div class="toolbar">
          <div class="hint" data-i18n="hintChipRemove">※ 선택한 칩을 클릭하면 제거됩니다.</div>
          <button id="btn-rewrite" class="btn primary">
            <span id="btn-rewrite-spinner" class="spinner" hidden></span>
            <span data-i18n="rewriteBtn">순화하기</span>
          </button>
        </div>

        <div id="rewrite-error" class="error-text" hidden></div>

        <div class="output-section">
          <div class="output-header">
            <span data-i18n="outputLabel">결과</span>
            <span id="output-note" class="output-note"></span>
          </div>

          <div id="output-list" class="output-list"></div>
        </div>
      </section>

      <!-- 히스토리 탭 -->
      <section id="view-history" class="view">
        <div id="history-info" class="info-text" data-i18n="historyProInfo">
          Pro 구독 시 최근 순화 기록을 확인할 수 있습니다.
        </div>
        <div id="history-list" class="history-list"></div>
      </section>

      <!-- 템플릿 탭 -->
      <section id="view-templates" class="view">
        <div id="tpl-info" class="info-text" data-i18n="templatesProInfo">
          Pro 구독 시 카테고리·톤·옵션을 템플릿으로 저장해 둘 수 있습니다.
        </div>

        <div id="tpl-warning" class="warning-text" hidden></div>

        <div id="tpl-editor" class="card" hidden>
          <div class="field-group">
            <label class="field-label" for="tpl-title" data-i18n="templateNameLabel">템플릿 이름</label>
            <input id="tpl-title" type="text" class="input"
                   placeholder="예: 업무용 정중·차분"
                   data-i18n-placeholder="templateNamePlaceholder" />
          </div>

          <div class="row">
            <div class="col">
              <label class="field-label" for="tpl-category" data-i18n="fieldCategory">카테고리</label>
              <select id="tpl-category" class="select">
                <option value="" data-i18n="noneOption">선택 없음</option>
                <option value="general" data-i18n="catGeneral">일반</option>
                <option value="work" data-i18n="catWork">업무</option>
                <option value="support" data-i18n="catSupport">고객응대</option>
                <option value="apology" data-i18n="catApology">사과</option>
                <option value="inquiry" data-i18n="catInquiry">문의</option>
                <option value="thanks" data-i18n="catThanks">감사</option>
                <option value="request" data-i18n="catRequest">요청</option>
                <option value="guidance" data-i18n="catGuidance">안내</option>
                <option value="report/approval" data-i18n="catReport">보고/결재</option>
                <option value="feedback" data-i18n="catFeedback">피드백</option>
              </select>
            </div>
            <div class="col">
              <label class="field-label" for="tpl-tone" data-i18n="fieldTone">톤</label>
              <select id="tpl-tone" class="select">
                <option value="" data-i18n="noneOption">선택 없음</option>
                <option value="soft" data-i18n="toneSoft">부드럽게</option>
                <option value="polite" data-i18n="tonePolite">정중하게</option>
                <option value="concise" data-i18n="toneConcise">간결하게</option>
                <option value="report" data-i18n="toneReport">보고서체</option>
                <option value="friendly" data-i18n="toneFriendly">친근하게</option>
                <option value="warmly" data-i18n="toneWarmly">따뜻하게</option>
                <option value="calmly" data-i18n="toneCalmly">차분하게</option>
                <option value="formally" data-i18n="toneFormally">격식 있게</option>
                <option value="clearly" data-i18n="toneClearly">명확하게</option>
                <option value="without_emotion" data-i18n="toneNoEmotion">감정 없이</option>
              </select>
            </div>
          </div>

          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-honorific" />
              <span data-i18n="tplHonorific">존댓말</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-opener" />
              <span data-i18n="tplOpener">완충문·인사</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-emoji" />
              <span data-i18n="tplEmoji">이모지</span>
            </label>
          </div>

          <div class="toolbar">
            <div></div>
            <button id="tpl-save" class="btn primary small" data-i18n="templateSaveCurrent">현재 설정 저장</button>
          </div>
        </div>

        <div id="tpl-list" class="tpl-list"></div>
        <br>
      </section>

      <!-- 설정 탭 -->
      <section id="view-settings" class="view">

        <div class="card" style="margin-bottom:10px;">
          <div style="display:flex; align-items:center; gap:8px; justify-content:space-between;">
            <div>
              <div style="font-weight:700;" data-i18n="accountConnect">계정 연결</div>
              <div class="muted" id="connStatus" style="font-size:12px;" data-i18n="connChecking">연결 상태 확인 중...</div>
            </div>
            <div style="display:flex; gap:6px;">
              <button class="btn small" id="btnConnect" data-i18n="connectBtn">연결</button>
              <button class="btn ghost small" id="btnDisconnect" data-i18n="disconnectBtn">해제</button>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 class="section-title" data-i18n="loginStatusTitle">로그인 상태</h3>
          <div id="settings-auth" class="info-text" data-i18n="authChecking">상태 확인 중...</div>
          <button id="settings-open-login" class="btn secondary small" data-i18n="openLoginWeb">
            웹에서 로그인 페이지 열기
          </button>
        </div>

        <div class="card">
          <h3 class="section-title" data-i18n="themeTitle">테마</h3>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="theme" value="light" checked />
              <span data-i18n="themeLight">라이트 모드</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="theme" value="dark" />
              <span data-i18n="themeDark">다크 모드</span>
            </label>
          </div>
          <div class="hint" data-i18n="themeHint">
            웹사이트 느낌과 비슷하게, 밝은/어두운 모드를 전환할 수 있어요.
          </div>
        </div>

        <div class="card">
          <h3 class="section-title" data-i18n="serverTargetTitle">연결 대상 서버</h3>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="env" value="prod" checked />
              <span data-i18n="serverProd">운영 서버 (https://www.lexinoa.com)</span>
            </label>
            <br>
            <label class="radio-item">
              <input type="radio" name="env" value="local" />
              <span data-i18n="serverLocal">로컬 개발 (http://127.0.0.1:5000)</span>
            </label>
          </div>
          <div class="hint" data-i18n="serverHint">
            로컬에서 테스트할 때만 "로컬 개발"을 선택하세요.
          </div>
        </div>

        <div class="card">
          <h3 class="section-title" data-i18n="extensionDataTitle">확장 데이터</h3>
          <button id="settings-reset" class="btn danger small" data-i18n="resetBtn">
            컨텍스트 / 내부 설정 초기화
          </button>
          <div id="settings-reset-msg" class="info-text"></div>
        </div>

      </section>
    </main>
  </div>

  <script src="popup.js"></script>
</body>
</html>
