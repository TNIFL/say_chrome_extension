<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Lexinoa 확장 프로그램</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div id="app">
    <header class="popup-header">
      <div class="brand">
        <div class="brand-mark">L</div>
        <div class="brand-text">
          <div class="brand-title">Lexinoa</div>
          <div class="brand-subtitle">문장 순화 도우미</div>
        </div>
      </div>
      <button id="open-web" class="btn ghost small">웹 열기</button>
    </header>

    <section class="status-bar">
      <div id="status-tier" class="badge">-</div>
      <div id="status-usage" class="status-text">사용량 불러오는 중...</div>
    </section>

    <nav class="tabs">
      <button class="tab-button active" data-target="view-rewrite">순화</button>
      <button class="tab-button" data-target="view-history">히스토리</button>
      <button class="tab-button" data-target="view-templates">템플릿</button>
      <button class="tab-button" data-target="view-settings">설정</button>
    </nav>

    <main class="views">
      <!-- 순화 탭 -->
      <section id="view-rewrite" class="view active">
        <div class="context-row">
          <div class="context-label">플랫폼 감지</div>
          <div class="context-value" id="context-display">일반 사이트</div>
          <select id="context-manual" class="context-select">
            <option value="auto" selected>자동</option>
            <option value="gmail">Gmail</option>
            <option value="slack">Slack</option>
            <option value="naver_mail">네이버 메일</option>
            <option value="outlook">Outlook</option>
            <option value="teams">Teams</option>
            <option value="kakao">카카오톡/카카오</option>
            <option value="generic">일반</option>
          </select>
        </div>

        <label class="field-label" for="input-text">입력</label>
        <textarea id="input-text" class="textarea" rows="5"
          placeholder="예) 왜 이렇게 늦게 보내세요? 다음부턴 제때 보내세요."></textarea>

        <div class="row">
          <div class="col">
            <label class="field-label" for="category-select">카테고리</label>
            <div class="input-group">
              <select id="category-select" class="select">
                <option value="" disabled selected>카테고리 선택…</option>
                <option value="general">일반</option>
                <option value="work">업무</option>
                <option value="support">고객응대</option>
                <option value="apology">사과</option>
                <option value="inquiry">문의</option>
                <option value="thanks">감사</option>
                <option value="request">요청</option>
                <option value="guidance">안내</option>
                <option value="report/approval">보고/결재</option>
                <option value="feedback">피드백</option>
              </select>
            </div>
            <div id="category-chips" class="chipbox"></div>
          </div>

          <div class="col">
            <label class="field-label" for="tone-select">톤</label>
            <div class="input-group">
              <select id="tone-select" class="select">
                <option value="" disabled selected>말투 선택…</option>
                <option value="soft">부드럽게</option>
                <option value="polite">정중하게</option>
                <option value="concise">간결하게</option>
                <option value="report">보고서체</option>
                <option value="friendly">친근하게</option>
                <option value="warmly">따뜻하게</option>
                <option value="calmly">차분하게</option>
                <option value="formally">격식 있게</option>
                <option value="clearly">명확하게</option>
                <option value="without_emotion">감정 없이</option>
              </select>
            </div>
            <div id="tone-chips" class="chipbox"></div>
          </div>
        </div>

        <div class="checkbox-group">
          <label class="checkbox-item">
            <input type="checkbox" id="opt-honorific" />
            <span>존댓말 유지</span>
          </label>
          <label class="checkbox-item">
            <input type="checkbox" id="opt-opener" />
            <span>완충문·인사 추가</span>
          </label>
          <label class="checkbox-item">
            <input type="checkbox" id="opt-emoji" />
            <span>이모지 허용 🙂</span>
          </label>
        </div>

        <div class="template-row">
          <div class="template-label">
            <span>템플릿</span>
            <span id="template-pro-badge" class="badge badge-pro" hidden>Pro</span>
          </div>
          <select id="template-select" class="select">
            <option value="" selected>템플릿 선택…</option>
          </select>
          <button id="template-save-from-current" class="btn small secondary">현재 설정 저장</button>
        </div>

        <div class="toolbar">
          <div class="hint">※ 선택한 칩을 클릭하면 제거됩니다.</div>
          <button id="btn-rewrite" class="btn primary">
            <span id="btn-rewrite-spinner" class="spinner" hidden></span>
            <span>순화하기</span>
          </button>
        </div>

        <div id="rewrite-error" class="error-text" hidden></div>

        <div class="output-section">
          <div class="output-header">
            <span>결과</span>
            <span id="output-note" class="output-note"></span>
          </div>

          <div id="output-list" class="output-list">
            <!-- 결과 카드들 (1~3개) -->
          </div>
        </div>
      </section>

      <!-- 히스토리 탭 -->
      <section id="view-history" class="view">
        <div id="history-info" class="info-text">
          Pro 구독 시 최근 순화 기록을 확인할 수 있습니다.
        </div>
        <div id="history-list" class="history-list"></div>
      </section>

      <!-- 템플릿 탭 -->
      <section id="view-templates" class="view">
        <div id="tpl-info" class="info-text">
          Pro 구독 시 카테고리·톤·옵션을 템플릿으로 저장해 둘 수 있습니다.
        </div>

        <div id="tpl-warning" class="warning-text" hidden></div>

        <div id="tpl-editor" class="card" hidden>
          <div class="field-group">
            <label class="field-label" for="tpl-title">템플릿 이름</label>
            <input id="tpl-title" type="text" class="input" placeholder="예: 업무용 정중·차분" />
          </div>

          <div class="row">
            <div class="col">
              <label class="field-label" for="tpl-category">카테고리</label>
              <select id="tpl-category" class="select">
                <option value="">선택 없음</option>
                <option value="general">일반</option>
                <option value="work">업무</option>
                <option value="support">고객응대</option>
                <option value="apology">사과</option>
                <option value="inquiry">문의</option>
                <option value="thanks">감사</option>
                <option value="request">요청</option>
                <option value="guidance">안내</option>
                <option value="report/approval">보고/결재</option>
                <option value="feedback">피드백</option>
              </select>
            </div>
            <div class="col">
              <label class="field-label" for="tpl-tone">톤</label>
              <select id="tpl-tone" class="select">
                <option value="">선택 없음</option>
                <option value="soft">부드럽게</option>
                <option value="polite">정중하게</option>
                <option value="concise">간결하게</option>
                <option value="report">보고서체</option>
                <option value="friendly">친근하게</option>
                <option value="warmly">따뜻하게</option>
                <option value="calmly">차분하게</option>
                <option value="formally">격식 있게</option>
                <option value="clearly">명확하게</option>
                <option value="without_emotion">감정 없이</option>
              </select>
            </div>
          </div>

          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-honorific" />
              <span>존댓말</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-opener" />
              <span>완충문·인사</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" id="tpl-emoji" />
              <span>이모지</span>
            </label>
          </div>

          <div class="toolbar">
            <div></div>
            <button id="tpl-save" class="btn primary small">템플릿 저장</button>
          </div>
        </div>

        <div id="tpl-list" class="tpl-list"></div>
        <br>
      </section>

      <!-- 설정 탭 -->
      <section id="view-settings" class="view">
        <div class="card" style="margin-bottom:10px;">
          <div style="display:flex; align-items:center; gap:8px; justify-content:space-between;">
            <div>
              <div style="font-weight:700;">계정 연결</div>
              <div class="muted" id="connStatus" style="font-size:12px;">연결 상태 확인 중…</div>
            </div>
            <div style="display:flex; gap:6px;">
              <button class="btn small" id="btnConnect">연결</button>
              <button class="btn ghost small" id="btnDisconnect">해제</button>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 class="section-title">로그인 상태</h3>
          <div id="settings-auth" class="info-text">
            상태 확인 중...
          </div>
          <button id="settings-open-login" class="btn secondary small">
            웹에서 로그인 페이지 열기
          </button>
        </div>
        <!-- 설정 탭 안에 추가 -->
        <div class="card">
          <h3 class="section-title">테마</h3>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="theme" value="light" checked />
              <span>라이트 모드</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="theme" value="dark" />
              <span>다크 모드</span>
            </label>
          </div>
          <div class="hint">
            웹사이트 느낌과 비슷하게, 밝은/어두운 모드를 전환할 수 있어요.
          </div>
        </div>

        <!-- 운영 환경 설정 (배포 시 주석 또는 제거) -->
        <!--
        <div class="card">
          <h3 class="section-title">연결 대상 서버</h3>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="env" value="prod" checked />
              <span>운영 서버 (https://www.lexinoa.com)</span>
            </label>
            <br>
            <label class="radio-item">
              <input type="radio" name="env" value="local" />
              <span>로컬 개발 (http://127.0.0.1:5000)</span>
            </label>
          </div>
          <div class="hint">
            로컬에서 테스트할 때만 "로컬 개발"을 선택하세요.
          </div>
        </div>
        -->
        <div class="card">
          <h3 class="section-title">확장 데이터</h3>
          <button id="settings-reset" class="btn danger small">
            컨텍스트 / 내부 설정 초기화
          </button>
          <div id="settings-reset-msg" class="info-text"></div>
        </div>
      </section>
    </main>
  </div>

  <script src="popup.js"></script>
</body>
</html>
